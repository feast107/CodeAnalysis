using System.Linq;
using System.Text;

namespace Feast.CodeAnalysis.Extensions;

internal static class Global
{
    private const string GenerateNamespace = $"{nameof(Microsoft)}.{nameof(CodeAnalysis)}";

    private const string GenerateUsing = """
                                         using System;
                                         using System.Collections.Generic;
                                         using System.Linq;
                                         using System.Reflection;
                                         using Microsoft.CodeAnalysis;
                                         using Microsoft.CodeAnalysis.CSharp;
                                         using Microsoft.CodeAnalysis.CSharp.Syntax;
                                         """;

    internal static string Generate(string className,params string[] methods) =>
        $$"""
          // <auto-generated/>

          {{GenerateUsing}}

          namespace {{GenerateNamespace}};

          public static partial class {{className}}
          {
          {{string.Concat(methods.Select(x=>$"\n{x}".Replace("\n", "\n\t")))}}
          }
          """;
    
    internal static string GenerateFileName(string className) =>
        $"{nameof(Feast)}.{nameof(Feast.CodeAnalysis)}.{nameof(Extensions)}.{className}.g.cs";

    internal const string CodeAnalysis = $"global::{GenerateNamespace}";
  
}